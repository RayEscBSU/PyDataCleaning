from sqlalchemy import create_engine, Column, Integer, String, Float
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
import pandas as pd

class CountyCategoryDetail(Base):
    __tablename__ = 'CountyCategoryDetail'
    Year = Column(Integer)
    Roll = Column(String)
    County_Number = Column('County Number'Integer)
    County_Name = Column('County Name',String, default = 'Ada')
    Region_Number = Column('Region Number', Integer, default = 3)
    Category = Column('Category Number', Integer)
    Acreage = Column(Float)
    Market_Value = Column('Market Value', Integer)
    Homeowner_s_Exemption = Column("Homeowner's Exemption", Integer)
    Increment = Column('Increment', Integer)
    Personal_Property_Exemption = Column('Personal Propery Exemption', Integer)
    Hardship = Column('Hardship', Integer)
    Pollution = Column('Pollution', Integer)
    New_Capital_Investment = Column('New Capital Investment (63-4502)', Integer)
    Business_Investment = Column('Business Investment (63-602NN)', Integer)
    Site_Improvement = Column('Site Improvement', Integer)
    Casualty_Loss = Column('Casualty Loss (63-602X)', Integer)
    QIE = Column('QIE', Integer)
    Net_Value = Column('Net Value', Integer)
    Residential_Urban = Column('Residential Urban', Integer)
    Residential_Rural = Column('Residential Rural', Integer)
    Commercial_Urban = Column('Commercial Urban', Integer)
    Commercial_Rural = Column('Commercial Rural', Integer)
    Ag = Column('Ag', Integer)
    Timber = Column('Timber', Integer)
    Mining = Column('Mining', Integer)
    
#Database connection details 
#String to connect to Tax database
db_connection_string = 'mssql+pyodbc://@TAXDB-PT001:1433/TestDB?driver=ODBC+Driver+17+for+SQL+Server&trusted_connection=yes'
engine = create_engine(db_connection_string) #connects to db
Session = sessionmaker(bind=engine) #haldes transactions
session = Session() #saving current session

#reading excel file
df = pd.read_excel(r"C:\Users\rescobedo\OneDrive - State of Idaho\RayE\2023 Example Reports\Ada\Ada Bunderson Report (Unformatted)From Ada 2023.xlsx")

existing_data = session.query(CountyCategoryDetail).all()
